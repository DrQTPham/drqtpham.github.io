<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EQD2 & BED Calculator v2 - Multi-Constraint</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üè• EQD2 & BED Calculator v2</h1>
            <p>C√¥ng c·ª• t√≠nh to√°n li·ªÅu sinh h·ªçc trong x·∫° tr·ªã</p>
            <p class="author">Ph√°t tri·ªÉn b·ªüi <strong>Dr. Q.T. Ph·∫°m</strong></p>
            <p style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                üìß <a href="mailto:qtphamhus@gmail.com" style="color: white; text-decoration: none;">qtphamhus@gmail.com</a>
            </p>
            <div style="background: #28a745; color: white; padding: 10px; border-radius: 6px; margin-top: 15px;">
                <strong>‚ú® Version 2.1 - Multi-Constraint Edition</strong><br>
                <small>T√≠nh to√°n T·∫§T C·∫¢ constraints c√πng l√∫c!</small>
            </div>
        </header>

        <main>
            <!-- Organ Dose Lookup & Calculator -->
            <section class="card">
                <h2>üìö Tra c·ª©u & T√≠nh to√°n Gi·ªõi h·∫°n Li·ªÅu C∆° quan</h2>
                <p style="color: #666; margin-bottom: 20px;">
                    Tra c·ª©u gi·ªõi h·∫°n li·ªÅu chu·∫©n, SBRT v√† t√≠nh to√°n li·ªÅu m·ªõi v·ªõi ph√¢n li·ªÅu kh√°c
                </p>
                
                <form id="organDoseLookupForm">
                    <div class="form-group">
                        <label for="organLookupSelector">Ch·ªçn c∆° quan:</label>
                        <select id="organLookupSelector">
                            <option value="">-- Ch·ªçn c∆° quan ƒë·ªÉ tra c·ª©u --</option>
                        </select>
                        <small style="color: #666; font-size: 0.85rem; margin-top: 5px; display: block;">
                            üí° Database 38 c∆° quan t·ª´ RTOG, QUANTEC, AAPM TG-101
                        </small>
                    </div>

                    <button type="button" class="btn btn-primary" onclick="lookupOrganDose()">
                        üîç Tra c·ª©u th√¥ng tin
                    </button>
                </form>

                <div id="organDoseLookupResults" style="display: none; margin-top: 20px;"></div>

                <!-- Custom Dose Calculator -->
                <div id="customDoseCalculatorSection" style="display: none; margin-top: 30px;">
                    <h3 style="color: #667eea;">üßÆ T√≠nh li·ªÅu v·ªõi ph√¢n li·ªÅu t√πy ch·ªânh</h3>
                    <p style="color: #666; margin-bottom: 15px;">
                        Nh·∫≠p li·ªÅu/ph√¢n li·ªÅu m·ªõi ƒë·ªÉ t√≠nh to√°n cho <strong>T·∫§T C·∫¢ constraints</strong> c·ªßa c∆° quan
                    </p>
                    <div class="form-group">
                        <label for="customDosePerFraction">Li·ªÅu/ph√¢n li·ªÅu m·ªõi (Gy):</label>
                        <input type="number" id="customDosePerFraction" step="0.1" min="0.1" placeholder="3.0">
                        <small>Nh·∫≠p li·ªÅu/ph√¢n li·ªÅu kh√°c v·ªõi chu·∫©n (2 Gy)</small>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="calculateCustomOrganDose()">
                        üßÆ T√≠nh li·ªÅu gi·ªõi h·∫°n m·ªõi cho T·∫§T C·∫¢ constraints
                    </button>
                    <div id="customOrganDoseResults" style="display: none; margin-top: 15px;"></div>
                </div>
            </section>

            <!-- Instructions -->
            <section class="card">
                <h2>üìñ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
                <ol style="line-height: 1.8;">
                    <li><strong>Ch·ªçn c∆° quan</strong> t·ª´ dropdown (v√≠ d·ª•: Rectum, Bladder, Heart)</li>
                    <li>Click <strong>"Tra c·ª©u th√¥ng tin"</strong> ƒë·ªÉ xem t·∫•t c·∫£ constraints chu·∫©n</li>
                    <li>Nh·∫≠p <strong>li·ªÅu/ph√¢n li·ªÅu m·ªõi</strong> (v√≠ d·ª•: 3.0 Gy)</li>
                    <li>Click <strong>"T√≠nh li·ªÅu gi·ªõi h·∫°n m·ªõi"</strong></li>
                    <li>Xem k·∫øt qu·∫£ cho <strong>T·∫§T C·∫¢ constraints</strong> (V15%, V25%, V35%, V50%, etc.)</li>
                </ol>

                <div style="background: #e7f3ff; padding: 15px; border-radius: 6px; margin-top: 20px; border-left: 3px solid #2196F3;">
                    <p style="margin: 0; font-size: 0.9rem; color: #0d47a1;">
                        <strong>‚ú® T√≠nh nƒÉng m·ªõi:</strong><br>
                        ‚Ä¢ T√≠nh to√°n cho <strong>T·∫§T C·∫¢ constraints</strong> thay v√¨ ch·ªâ m·ªôt constraint<br>
                        ‚Ä¢ Hi·ªÉn th·ªã k·∫øt qu·∫£ theo b·∫£ng chi ti·∫øt v·ªõi t·ª´ng % volume<br>
                        ‚Ä¢ So s√°nh BED v√† Safety Margin cho m·ªói constraint<br>
                        ‚Ä¢ Status ri√™ng (‚úÖ/‚ùå) cho t·ª´ng constraint
                    </p>
                </div>
            </section>
        </main>

        <footer>
            <p>¬© 2025 EQD2 & BED Calculator v2 - Multi-Constraint Edition</p>
            <p style="margin-top: 10px; font-size: 0.95rem;">
                Ph√°t tri·ªÉn b·ªüi <strong>Dr. Q.T. Ph·∫°m</strong> üë®‚Äç‚öïÔ∏è
            </p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                üìß Li√™n h·ªá: <a href="mailto:qtphamhus@gmail.com" style="color: white; text-decoration: none;">qtphamhus@gmail.com</a>
            </p>
        </footer>
    </div>

    <!-- Organ Dose Lookup Scripts - Using V2 -->
    <script src="js/organ-dose-database.js?v=2"></script>
    <script src="js/bed-calculator.js?v=2"></script>
    <script src="js/validation-engine.js?v=2"></script>
    <script src="js/organ-dose-ui-v2.js?v=2"></script>
    
    <script>
        // Show alert function
        function showAlert(message, type = 'info') {
            const typeMap = {
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'success': '‚úÖ',
                'info': '‚ÑπÔ∏è'
            };
            alert(`${typeMap[type]} ${message}`);
        }

        console.log('‚úÖ EQD2 Calculator v2 loaded - Multi-Constraint Edition');
        console.log('üìù All scripts loaded with version 2');
    </script>
</body>
</html>
