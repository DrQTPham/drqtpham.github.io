<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Debug Organ Calculator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { padding: 8px; width: 300px; font-size: 14px; }
        button { padding: 10px 20px; background: #667eea; color: white; border: none; cursor: pointer; font-size: 16px; }
        button:hover { background: #5568d3; }
        #organLimitResults { margin-top: 20px; padding: 20px; background: #f0f0f0; border-radius: 8px; }
        .alert { padding: 15px; margin: 10px 0; border-radius: 5px; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .alert-info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üß™ Debug Organ Limit Calculator</h1>
    
    <div id="debugInfo" style="background: #ffffcc; padding: 10px; margin-bottom: 20px; border-radius: 5px;">
        <h3>Debug Info:</h3>
        <p id="functionCheck">Checking...</p>
        <p id="elementCheck">Checking elements...</p>
    </div>

    <div class="form-group">
        <label for="organName">T√™n c∆° quan:</label>
        <select id="organName">
            <option value="">-- Ch·ªçn c∆° quan --</option>
            <option value="spinal_cord">T·ªßy s·ªëng (Spinal Cord)</option>
            <option value="brainstem">Th√¢n n√£o (Brainstem)</option>
        </select>
    </div>

    <div class="form-group">
        <label for="standardDoseLimit">Li·ªÅu gi·ªõi h·∫°n chu·∫©n (2 Gy/fx) - Gy:</label>
        <input type="number" id="standardDoseLimit" step="0.1" value="45" />
    </div>

    <div class="form-group">
        <label for="organAlphaBeta">Œ±/Œ≤ c·ªßa c∆° quan - Gy:</label>
        <input type="number" id="organAlphaBeta" step="0.1" value="2.0" />
    </div>

    <div class="form-group">
        <label for="newDosePerFraction">Li·ªÅu/ph√¢n li·ªÅu m·ªõi - Gy:</label>
        <input type="number" id="newDosePerFraction" step="0.1" value="3.0" />
    </div>

    <button onclick="testCalculation()">üßÆ Test Calculation</button>

    <div id="organLimitResults" style="display: none;"></div>

    <script src="js/app.js"></script>
    <script>
        // Debug checks
        window.addEventListener('load', () => {
            const funcCheck = document.getElementById('functionCheck');
            const elemCheck = document.getElementById('elementCheck');
            
            // Check if function exists
            if (typeof window.calculateOrganLimit === 'function') {
                funcCheck.innerHTML = '‚úÖ calculateOrganLimit function exists';
                funcCheck.style.color = 'green';
            } else {
                funcCheck.innerHTML = '‚ùå calculateOrganLimit function NOT found';
                funcCheck.style.color = 'red';
            }
            
            // Check if elements exist
            const elements = ['organName', 'standardDoseLimit', 'organAlphaBeta', 'newDosePerFraction', 'organLimitResults'];
            const missing = elements.filter(id => !document.getElementById(id));
            
            if (missing.length === 0) {
                elemCheck.innerHTML = '‚úÖ All required elements found';
                elemCheck.style.color = 'green';
            } else {
                elemCheck.innerHTML = '‚ùå Missing elements: ' + missing.join(', ');
                elemCheck.style.color = 'red';
            }
            
            console.log('Debug page loaded');
            console.log('calculateOrganLimit:', window.calculateOrganLimit);
        });
        
        function testCalculation() {
            console.log('=== TEST CALCULATION STARTED ===');
            
            // Get values
            const standardLimit = document.getElementById('standardDoseLimit').value;
            const organAlphaBeta = document.getElementById('organAlphaBeta').value;
            const newDosePerFraction = document.getElementById('newDosePerFraction').value;
            
            console.log('Input values:', {
                standardLimit,
                organAlphaBeta,
                newDosePerFraction
            });
            
            // Call the function
            if (typeof window.calculateOrganLimit === 'function') {
                console.log('Calling calculateOrganLimit...');
                window.calculateOrganLimit();
            } else {
                console.error('calculateOrganLimit function not found!');
                alert('ERROR: calculateOrganLimit function not found!');
            }
        }
    </script>
</body>
</html>
